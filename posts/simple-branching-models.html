<!DOCTYPE html>
<html lang="en">
<head profile="http://www.w3.org/2005/10/profile">
  <meta charset="UTF-8">
  <meta name="description" content="Yair&#39;s website">
  <meta name="author" content="Yair Chuchem">
  <meta name=viewport content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@yairchu">
<meta name="twitter:creator" content="@yairchu">
<meta name="twitter:title" content="Simple Git branching models (DRAFT)">
  <meta name="twitter:description" content="Two simple Git branching models">
  <meta name="twitter:image" content="https://yairchu.github.io//images/merging-neutron-stars.jpg">
  <title>Simple Git branching models (DRAFT)</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/syntax.css">
  <meta property="og:title" content="Simple Git branching models (DRAFT)" />
  <meta property="og:image" content="https://yairchu.github.io/images/merging-neutron-stars.jpg" />
</head>
<body>
  <header>
      <nav>
          <a id="beacon" href="/">
              <div id="home-text"> HOME </div>
          </a>
      </nav>
  
      <div class="right-sidebar">
          <a class="ext-link" href="https://github.com/yairchu">
            <img src="/images/github-logo.png" alt="Github Profile"/>
        </a>

          <a class="ext-link" href="https://twitter.com/yairchu">
            <img src="/images/twitter-logo.png" alt="Twitter Profile"/>
        </a>
    <div id="theme-button">DAY</div>
      </div>
  </header>

<div id="page">
  <div class="wrapper">
    <div class="masthead">
      <span class="title">
        Simple Git branching models (DRAFT)
      </span>

      <img class="post-image" src="/images/merging-neutron-stars.jpg">
      <span class="byline">by Yair Chuchem</span>
      <span class="date">2020.11.4</span>
      <div class="metadata">
      </div>
      <div class="tags">
        <a href="/tag/code" class="tag">code</a>
        <a href="/tag/git" class="tag">git</a>
      </div>
    </div>
  </div>
  <article class="post">
    <p>In this post I'll present two simple software development models, each suitable for different needs:</p>
<ul>
<li>The "Modal Flow", for very small or single-person teams that make releases occasionally (not often)</li>
<li>The "Light Flow", for teams releasing updates regularly (weekly/monthly). It is a simplified variant of the well known <a href="https://nvie.com/posts/a-successful-git-branching-model/">"GitFlow"</a></li>
</ul>
<p><strong>TODO: Better names for the flows?</strong></p>
<h2 id="the-modal-flow">The Modal Flow</h2>
<p><img src="/images/modal-flow.svg" alt="Modal Flow State Machine" /></p>
<p>Modality means that the development has cycles that switch between two modes:</p>
<ul>
<li>Free dev. At this stage you are more likely to do big changes in the codebase.</li>
<li>Preparing to ship, aka <a href="https://en.wikipedia.org/wiki/Freeze_(software_engineering)">"code freeze"</a>. At this stage you're only fixing bugs and problems in the product.</li>
</ul>
<p>Even when not specifically planning to use this flow, many teams may find themselves using it. It tends to happen when you need to cut a release and find that there are too many bugs in the main branch. In that case it tends to come naturally to decide: "let's focus on fixing these bugs now and keep the new features for later".</p>
<p><em>The mutex analogy: A freeze is mutually exclusive with adding features to <code>main</code>.</em></p>
<h3 id="the-burden-of-modality">The burden of modality</h3>
<p>If you ever hear an <em>"Oh, I wasn't aware that we're in a feature freeze"</em>, that's because communication is tricky. Someone may have missed a meeting, or announcements in the chat channel may have been drowned by other messages. If you find coordinating the state to be tricky, it may make sense to use a flow that formalizes the modes of development in the structure of the git branches.</p>
<h2 id="the-light-flow">The Light Flow</h2>
<p><img src="/images/light-flow.svg" alt="Light Flow Commit Tree" /></p>
<p>The different types of branches and commits in the diagram:</p>
<ul>
<li>The main branch in the middle is colored in yellow</li>
<li>Feature branches are colored purple. They are surrounded by dashes to signify that they are temporary: some might be aborted, others will be rebased and will ultimately become normal commits in <code>main</code></li>
<li>Release branches are colored in green. They end up with a release and are merged into <code>main</code></li>
<li>Releases, given <code>git tag</code>s, are displayed as rectangular nodes</li>
</ul>
<h3 id="how-to-light-flow">How to light flow</h3>
<ul>
<li>Developers can freely add new features to <code>main</code> at all times!</li>
<li>A bug tracker is used to keep track of tasks
<ul>
<li>A list of known "blocker" bugs that shouldn't be in a release is maintained</li>
<li>A list of new and not yet well tested features in the <code>main</code> branch is also maintained</li>
<li>For each blocker bug or new feature, the commit which introduced it is identified in its issue</li>
<li>When fixing bugs, the commit messages should specify which bugs were fixed</li>
</ul></li>
<li>Preparing a release
<ul>
<li>If the <code>main</code> branch happens to be in a good, bug-free state, then we're in luck, and just <code>git tag</code> it as a release candidate!</li>
<li>If we still have bugs to fix for the release, then we open a release branch</li>
</ul></li>
</ul>
<h3 id="using-a-release-branch">Using a release branch</h3>
<p>When the <code>main</code> branch is not suitable for release as is, the person in charge of the release will create a branch from a selected commit in <code>main</code>, calling it <code>fixes-VERSION</code>, or informally "the current release branch".</p>
<ul>
<li>Bug fixes are added to the release branch</li>
<li>Once the known bugs appear to be fixed, tag and build a release candidate</li>
<li>If new issues are discovered in the RC, go back to fixing bugs on the branch</li>
<li>When the RC is good: ship the release, tag it, and merge the branch back into <code>main</code>, and merge with a real merge commit rather than rebasing, to keep the actual release in <code>main</code>'s history</li>
</ul>
<h4 id="how-to-choose-a-branching-point-for-the-release-branch">How to choose a branching point for the release branch</h4>
<p>The commit messages and the bug tracker help us "taint" the states in the <code>main</code> branch with existence of various bugs.</p>
<ul>
<li>Unfixed bugs taint <code>main</code> since they were introduced</li>
<li>Bugs that were fixed taint only a specific range of commits</li>
</ul>
<p>A good point to start the release branch is one which is relatively clean, yet also includes valueable features which improve upon the previous release.</p>
<p>If the chosen point doesn't include all the fixes currently available in <code>main</code>, we'll <code>git cherry-pick</code> them into the release branch.</p>
<h2 id="how-does-light-flow-compare-to-other-flows">How does Light Flow compare to other flows</h2>
<h3 id="differences-from-the-github-flow">Differences from the GitHub Flow</h3>
<p>The <a href="https://guides.github.com/introduction/flow/">GitHub Flow</a> is very simple. It has no release branches, and the <code>main</code> branch is deployed to production as is (after testing).</p>
<p>I believe that to really make it work, one has to, either explicitly or implicitly, impose feature freezes, and this means that for projects where stability is a priority, the GitHub Flow tends to become the Modal Flow.</p>
<h3 id="differences-from-gitflow">Differences from GitFlow</h3>
<p><em>Note that Vincent Driessen, the creator of GitFlow, <a href="https://nvie.com/posts/a-successful-git-branching-model/">currently recommends</a> most projects to adopt the <a href="https://guides.github.com/introduction/flow/">"GitHub flow"</a> instead.</em></p>
<p>GitFlow is more complicated:</p>
<ul>
<li><code>main</code> is called <code>develop</code></li>
<li>An additional <code>master</code> branch points to the latest release</li>
<li>It explicitly describes a process for <em>hotfix branches</em>, which branch out of previous releases and add fixes to them. This makes sense for projects which maintain multiple versions. This may happen if new versions of the product are paid upgrades but old version still get bug fixes. For such projects GitFlow is probably a very good choice</li>
</ul>
<p>The Light Flow's omission of hotfix branches aims to put an emphasis on releasing new developments from <code>main</code> more often, to avoid accumulating a gap of unreleased and unstable features.</p>
<h3 id="does-the-light-flow-work">Does the Light Flow work</h3>
<p>I wrote this post in order to suggest this model for the development of <a href="https://pajam.live/">Pajam</a> (btw, if you happen to be a musician that wants to jam with their friends remotely, I highly recommend you to give Pajam a try!)</p>
<p>If we indeed decide to adopt this model, then after a while I will update this section with our results.</p>
<h2 id="notes">Notes</h2>
<ul>
<li>Image credit: <a href="https://en.m.wikipedia.org/wiki/File:Eso1733s_Artist%27s_impression_of_merging_neutron_stars.jpg">University of Warwick/Mark Garlick</a></li>
<li>The diagrams are inspired by the diagram for <a href="https://nvie.com/posts/a-successful-git-branching-model/">GitFlow</a>, and the colors were specifically chosen to be consistent with it for easy comparison</li>
</ul>

    <br>
    <br>

    <!--Share buttons-->
    <div class="social-buttons">
      <a href="https://twitter.com/share" class="twitter-share-button" data-text="Check out: Simple Git branching models (DRAFT) - " data-via="yairchu">Tweet</a>
      <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
      <a href="https://twitter.com/yairchu" class="twitter-follow-button" data-show-count="false" data-dnt="true">Follow @yairchu</a>
      <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
      <div class="fb-like" data-href="" data-layout="button" data-action="like" data-show-faces="true" data-share="true"></div>
    </div>
</article>

</div>

<footer>
    Web site built with Haskell using <a href="https://github.com/ChrisPenner/slick">slick</a> ❤️
</footer>

<link href='https://fonts.googleapis.com/css?family=Quicksand:300,400' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
<script src="/js/main.js"></script>
</body>
</html>

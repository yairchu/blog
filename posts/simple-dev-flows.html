<!DOCTYPE html>
<html lang="en" dir="ltr">
<head profile="http://www.w3.org/2005/10/profile">
  <meta name="description" content="Yair&#39;s website">
  <meta name="author" content="Yair Chuchem">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@yairchu">
<meta name="twitter:creator" content="@yairchu">
<meta name="twitter:title" content="Simple Dev/Release Workflows">
  <meta name="twitter:description" content="Two simple development models">
  <meta name="twitter:image" content="https://yairchu.github.io//images/merging-neutron-stars.jpg">
  <title>Simple Dev/Release Workflows</title>
  <link rel="stylesheet" href="/css/syntax.css">
  <meta property="og:title" content="Simple Dev/Release Workflows" />
  <meta property="og:image" content="https://yairchu.github.io/images/merging-neutron-stars.jpg" />
  <meta charset="UTF-8">
  <meta name=viewport content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/css/style.css">
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-3ZVL4J64MW"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-3ZVL4J64MW');
  </script>
</head>
<body>
  <header dir="ltr">
      <nav>
          <a href="/"> HOME </a>
          <a href="/projects/recommendations"> FAVS </a>
      </nav>
  
      <div class="right-sidebar">
          <a class="ext-link" href="https://github.com/yairchu">
            <img src="/images/github-logo.png" alt="Github Profile"/>
        </a>

          <a class="ext-link" href="https://twitter.com/yairchu">
            <img src="/images/twitter-logo.png" alt="Twitter Profile"/>
        </a>
    <div id="theme-button">DAY</div>
      </div>
  </header>

<div id="page">
  <div class="wrapper">
    <div class="masthead">
      <span class="title">
        Simple Dev/Release Workflows
      </span>

      <img class="post-image" src="/images/merging-neutron-stars.jpg">
      <span class="byline">by Yair Chuchem</span>
      <span class="date">2020.11.05</span>
      <div class="metadata">
      </div>
      <div class="tags">
        <a href="/tag/code" class="tag">code</a>
        <a href="/tag/git" class="tag">git</a>
        <a href="/tag/teamwork" class="tag">teamwork</a>
      </div>
    </div>
  </div>
  <article class="post">

    <p>In this post I'll introduce very simple software development
workflows, each suitable for different needs:</p>
<ul>
<li>The "Red Light, Green Light Flow", suitable for occasional
releases</li>
<li>The "Light Flow", suitable for regular releases
(weekly/monthly)</li>
<li>I will also compare them to <a
href="https://guides.github.com/introduction/flow/">the GitHub Flow</a>,
<a
href="https://nvie.com/posts/a-successful-git-branching-model/">"GitFlow"</a>,
and <a href="https://trunkbaseddevelopment.com/">"Trunk Based
Development"</a>.</li>
</ul>
<h2 id="the-red-light-green-light--feature-freeze-flow">The Red Light,
Green Light / Feature Freeze Flow</h2>
<p><img src="/images/rlgl-flow.svg" alt="RLGL State Machine" /></p>
<p>Like in the famous children's game of "Red Light, Green Light" (aka
"Statues", and <a
href="https://en.wikipedia.org/wiki/Statues_(game)">many other
names</a>), development switches between two modes:</p>
<ul>
<li>Free dev. New features are developed freely and big changes may
happen to the codebase, often introducing bugs.</li>
<li>Preparing to ship, aka <a
href="https://en.wikipedia.org/wiki/Freeze_(software_engineering)">"code
freeze"</a>. At this stage bugs and problems are fixed.</li>
</ul>
<p>When preparing releases and not deliberately choosing a workflow,
work tends to naturally develop into the RLGL flow. When you find that
there are too many bugs, it may come naturally to decide: "let's focus
on fixing bugs now and keep the new features for later".</p>
<p><em>The mutex analogy: A freeze is mutually exclusive with adding
features to <code>main</code>.</em></p>
<h3 id="challenges-with-statefulness-and-concurrency">Challenges with
statefulness and concurrency</h3>
<p>If you ever heard an <em>"Oh! I wasn't aware that we're in a feature
freeze"</em>, that's because communication is tricky. Someone may have
missed a meeting, or announcements in the group chat may have been
drowned by other messages. If you find coordinating the state to be
tricky, it may make sense to use a flow that formalizes the modes of
development in the structure of the git branches.</p>
<h2 id="the-light-flow">The Light Flow</h2>
<p><img src="/images/light-flow.svg" alt="Light Flow Commit Tree" /></p>
<p>The different types of branches and commits in the diagram:</p>
<ul>
<li>The main branch in the middle is colored in yellow</li>
<li>Feature branches are colored purple. They are surrounded by dashes
to signify that they are temporary: some might be aborted, others will
be rebased and will ultimately become normal commits in
<code>main</code></li>
<li>Release branches are colored in green. They end up with a release
and are merged into <code>main</code></li>
<li>Releases, given <code>git tag</code>s, are displayed as rectangular
nodes</li>
</ul>
<h3 id="how-to-light-flow">How to Light Flow</h3>
<ul>
<li>Developers can freely add new features to <code>main</code> at all
times!</li>
<li>A bug tracker is used to keep track of tasks
<ul>
<li>A list of known bugs that shouldn't be in a release is
maintained</li>
<li>A list of fresh and not yet well tested features in the
<code>main</code> branch is also maintained</li>
<li>For each bug or feature, the commit which introduced it is
identified in its issue</li>
<li>Bugfix commits should mention which bugs were fixed</li>
</ul></li>
<li>Preparing a release
<ul>
<li>If the <code>main</code> branch happens to be in a good bug-free
state, then we're in luck, and just <code>git tag</code> it as a release
candidate!</li>
<li>If we still have bugs to fix for the release, then we open a release
branch</li>
</ul></li>
</ul>
<h3 id="using-a-release-branch">Using a release branch</h3>
<p>When the <code>main</code> branch is not suitable for release as is,
the person in charge of the release will create a branch from a selected
commit in <code>main</code>, calling it <code>fixes-VERSION</code>, or
informally "the current release branch".</p>
<ul>
<li>Bug fixes are added to the release branch</li>
<li>Once the known bugs appear to be fixed, tag and build a release
candidate</li>
<li>If new issues are discovered in the RC, go back to the previous
stage</li>
<li>When the RC is good: ship the release, tag it, and merge the branch
back into <code>main</code>. Merge it - don't rebase, so that the actual
release is in <code>main</code>'s history</li>
</ul>
<h3 id="how-to-choose-a-branching-point-for-the-release-branch">How to
choose a branching point for the release branch</h3>
<p>The commit messages and the bug tracker help us "taint" the states in
the <code>main</code> branch with existence of various bugs.</p>
<ul>
<li>Unfixed bugs taint <code>main</code> since they were introduced</li>
<li>Bugs that were fixed taint only a specific range of commits</li>
</ul>
<p>A good point to start the release branch is one which is relatively
clean, yet also includes valueable features which improve upon the
previous release.</p>
<p>If the chosen point doesn't include all the fixes currently available
in <code>main</code>, we'll <code>git cherry-pick</code> them into the
release branch.</p>
<h3 id="caution-with-reverts-on-the-release-branch">Caution with reverts
on the release branch</h3>
<p>Sometimes we may want to <code>git revert</code> a commit only for a
release branch. In this case we should keep in mind that if we merge the
release branch as is, the revert will propagate into <code>main</code>.
If we wish to avoid that, we should remember to un-revert the
commit!</p>
<h2 id="how-does-light-flow-compare-to-other-workflows">How does Light
Flow compare to other workflows</h2>
<h3 id="the-github-flow">The GitHub Flow</h3>
<p>The <a href="https://guides.github.com/introduction/flow/">GitHub
Flow</a> has a <code>main</code> branch and feature branches, without
release branches.</p>
<p>Its tools to avoid bugs are code reviews for all changes and rolling
back faulty versions. If you can un-deploy faulty versions, which is
often possible for web apps, and can put in the time and effort to do
good code review, then this flow might work well for you.</p>
<p>If you prefer to avoid faulty releases, and prefer to not extensively
code review each and every change, then the Light Flow is probably a
better fit.</p>
<h3 id="comparison-to-gitflow">Comparison to GitFlow</h3>
<p><image alt="GitFlow" src="/images/gitflow.png" width="350px" /></p>
<p><em>Note that Vincent Driessen, the creator of GitFlow, <a
href="https://nvie.com/posts/a-successful-git-branching-model/">currently
recommends</a> most projects to adopt the GitHub Flow instead.</em></p>
<p>The Light flow is a simplified variant of GitFlow. The differences
are:</p>
<ul>
<li><code>main</code> is called <code>develop</code></li>
<li>An additional <code>master</code> branch points to the latest
release</li>
<li>GitFlow suggests to use explicit merge commits when merging feature
branches, while the Light Flow recommends rebases</li>
<li>GitFlow explicitly describes a process for <em>hotfix branches</em>,
which branch out of previous releases and add fixes to them. This makes
sense for projects which maintain multiple versions. This may happen if
new versions of the product are paid upgrades but old version still get
bug fixes. For such projects GitFlow is probably a very good
choice.</li>
</ul>
<p>The Light Flow's recommendation for rebasing feature branches and
omission of hotfix branches puts an emphasis on integrating new
developments faster and releasing them from <code>main</code> more
often, to avoid accumulating a gap of unreleased and unstable
features.</p>
<h3 id="comparison-to-trunk-based-development">Comparison to Trunk Based
Development</h3>
<p>The <a href="https://trunkbaseddevelopment.com/">Trunk Based
Development</a> may seem similar to the light flow, as the difference is
small: It prescribes that release branches <strong>should not</strong>
be merged back to <code>main</code>.</p>
<p>Its site refers to the Light Flow by the name <a
href="https://trunkbaseddevelopment.com/alternative-branching-models/#mainline">"Mainline"</a>
(note that their description predates this post), and it considers it as
the "diametrically opposite to Trunk-Based Development", and
furthermore, recommends not to use it! But personally I'm not convinced,
and I'll demonstrate with a simple example how the small difference
between workflow affects things:</p>
<p>Imagine that we decided to revert a commit in a release branch.</p>
<p>The following diagram represents the diff between Light Flow and
Trunk based in this scenario, in the form of a bright pink cherry-pick
commit and pink arrows denoting merges of release branches back to
<code>main</code>:</p>
<p><img src="/images/light-flow-vs-trunk-based.svg"
alt="Light Flow vs Trunk Based" /></p>
<p>Doing <code>git log release-2.4..release2.5</code> in this example
would list the correct changes list of changes between these releases
with the Light Flow, but using Trunk-Based it will be have a misleading
result for this log that omits the re-introduction of the reverted
change.</p>
<h2 id="does-the-light-flow-work">Does the Light Flow work</h2>
<p><a href="https://pajam.live/"><image alt="pajam!" src="/images/pajam-icon.svg" width="75px" /></a></p>
<p>I wrote this post in order to suggest this model for the development
of <a href="https://pajam.live/">Pajam</a> (btw, if you happen to be a
musician that wants to jam with their friends remotely, I highly
recommend you to give Pajam a try!).</p>
<p>Update from 2021.01.26: So far this flow is working very well for
us!</p>
<h2 id="notes">Notes</h2>
<ul>
<li>Discussion on
<img src="/images/reddit.svg" alt="reddit" style="width: 20px; display: inline;"/>
<a
href="https://www.reddit.com/r/programming/comments/juja4y/simple_devrelease_workflows/">r/programming</a></li>
<li>Image credits:
<ul>
<li>Title image (merging neutron stars): <a
href="https://en.m.wikipedia.org/wiki/File:Eso1733s_Artist%27s_impression_of_merging_neutron_stars.jpg">University
of Warwick/Mark Garlick</a></li>
<li>GitFlow: <a
href="https://nvie.com/posts/a-successful-git-branching-model/">Vincent
Driessen</a></li>
</ul></li>
<li>The Light Flow Diagram's colors are inspired by the diagram for
GitFlow, and were specifically chosen to be consistent with it for easy
comparison</li>
<li>Updates:
<ul>
<li>2020.11.16: Comparison with "Trunk Based Development"</li>
</ul></li>
</ul>

    <!--Comments-->
    <script src="https://giscus.app/client.js"
      data-repo="yairchu/yairchu.github.io"
      data-repo-id="MDEwOlJlcG9zaXRvcnkyMTI0MDQ3MDk="
      data-category="Announcements"
      data-category-id="DIC_kwDODKkJ5c4Ckke9"
      data-mapping="pathname"
      data-strict="0"
      data-reactions-enabled="1"
      data-emit-metadata="0"
      data-input-position="bottom"
      data-theme="light"
      data-lang="en"
      crossorigin="anonymous"
      async>
    </script>

    <!--Share buttons-->
    <div class="social-buttons">
      <a href="https://twitter.com/share" class="twitter-share-button" data-text="Check out: Simple Dev/Release Workflows - " data-via="yairchu">Tweet</a>
      <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
      <a href="https://twitter.com/yairchu" class="twitter-follow-button" data-show-count="false" data-dnt="true">Follow @yairchu</a>
      <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
      <div class="fb-like" data-href="" data-layout="button" data-action="like" data-show-faces="true" data-share="true"></div>
    </div>
  </article>

</div>

<footer>
    Web site built with Haskell using <a href="https://github.com/ChrisPenner/slick">slick</a> ❤️
</footer>

<link href='https://fonts.googleapis.com/css?family=Quicksand:300,400' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
<script src="/js/main.js"></script>
</body>
</html>
